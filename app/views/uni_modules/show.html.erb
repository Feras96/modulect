<% provide(:title, @uni_module.code + " " +@uni_module.name) %>
<div class="banner" style="padding-top:40px;">
   <div class="container">
      <h1>Module details</h1>
   </div>
</div>
<div id="page" style="padding-top:30px;">
<div class="container">
<div class="row">
   <div class="col-md-10 col-md-offset-1">
      <div class="row" style="margin-bottom:20px">
         <div class="col-md-6">
            <a onclick="window.history.back();" class="btn btn-default navbar-btn">< Back</a>
         </div>
         <div class="col-md-6 text-right">
            <% if logged_in? %>
            <script>
               $(window).load(function(){
               $("#save-<%= @uni_module.code%>").click(function() {
               $("#save-<%= @uni_module.code%> span").html($("#save-<%= @uni_module.code%> span").html() == '<i class="fa fa-star" aria-hidden="true"></i>&nbsp;&nbsp;Saved' ? '<span><i class="fa fa-star-o" aria-hidden="true"></i>&nbsp;&nbsp;Save Module' : '<i class="fa fa-star" aria-hidden="true"></i>&nbsp;&nbsp;Saved');
               });});
               
            </script>
            <% if current_user.uni_modules.include?(@uni_module) %>
            <button type="submit" class="btn btn-lg btn-small save-button" id="save-<%= @uni_module.code%>"><span><i class="fa fa-star" aria-hidden="true"></i>&nbsp;&nbsp;Saved</span>
            </button>
            <% else %>
            <button type="submit" class="btn btn-lg btn-small save-button" id="save-<%= @uni_module.code%>"><span><i class="fa fa-star-o" aria-hidden="true"></i>&nbsp;&nbsp;Save Module</span>
            </button>
            <% end %>
            <script>
               $("button#save-<%= @uni_module.code%>").on("click", function(){
                   $.ajax({
                      type: "POST",
                       url: "<%=application_save_module_path(module_par: @uni_module) %>",
                       context: document.body
                   })
               
               
               
               
               });
               
               
            </script>
            <% else %>
            <form action="/login" method="get">
               <button type="submit" class="btn btn-lg btn-small btn-disabled save-button" data-toggle="tooltip"  data-placement="left" title="To save modules, you must be logged in."><span><i class="fa fa-star-o" aria-hidden="true"></i>&nbsp;&nbsp;Save Module</span>
               </button>
            </form>
            <% end %>
         </div>
      </div>
      <%= render partial: 'layouts/uni_module', locals: {uni_module: @uni_module, tags_matched: "", tags_searched_for: "", type: "show"}  %>
      <div class="col-md-12 login-card res-card">
         <div class="row">
            <div class="col-md-9 result-card-main">
              <h2>Module Review</h2>

              <% @uni_module.comments.each do |comment| %>
                <p>
                  <strong>Commenter:</strong>
                  <%= comment.commenter %>
                </p>
                <p>
                  <strong>Rating:</strong>
                  <%= comment.rating %>
                </p>
                <p>
                  <strong>Review:</strong>
                  <%= comment.body %>
                </p>
                <br>
              <%end%>

              <h2>Add a Review</h2>

              <%= form_for([@uni_module, @uni_module.comments.build]) do |f| %>
                  <p>
                    <%= f.label :commenter %>
                    <%= f.text_field :commenter%>
                  </p>
                  <p>
                    <%= f.label :rating %><br>
                    <div id="rating-area">
                      <%= f.radio_button :rating, 1, :checked => true%><%= f.label :rating_1, '1' %>
                      <%= f.radio_button :rating, 2 %><%= f.label :rating_2, '2' %>
                      <%= f.radio_button :rating, 3 %><%= f.label :rating_3, '3' %>
                      <%= f.radio_button :rating, 4 %><%= f.label :rating_4, '4' %>
                      <%= f.radio_button :rating, 5 %><%= f.label :rating_5, '5' %>
                    </div>
                  </p>
                  <p>
                    <%= f.label :body %><br>
                    <%= f.text_area :body %>
                  </p>
                  <p>
                    <%= f.submit %>
                  </p>
              <% end %>

              <style>
                #rating-area input[type=radio] {display:inline-block;}
              </style>

            </div>
         </div>
      </div>
   </div>
</div>
</div>
</div>