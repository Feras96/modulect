<% provide(:title, 'Modules') %>
<header class="header">
  <h1 class="header__heading" id="page-title">Users</h1>
  <div class="header__actions">
    <%= link_to(
            "<i class='fa fa-plus' aria-hidden='true'></i>&nbsp;&nbsp;New User",
            new_admin_user_path,
            class: "button",
        ) %>
  </div>
</header>
<div class="table-responsive">
  <table aria-labelledby="page-title" class="collection-data table">
    <thead>
    <tr>
      <% # use this for sorting, specify columns to sort by, and that's it %>
      <% sorting_colums = {"first_name" => "First_name", "last_name" => "Last_name","email" => "Email", "user_level" => "User_level"} %>
      <% sorting_colums.each do |column| %>
          <th class="cell-label cell-label--string cell-label--false" scope="col">
            <% if request.query_parameters["sortby"] == column.first %>
                <% if request.query_parameters["order"] == "asc" %>
                    <%= link_to (column.second + " <i class='fa fa-arrow-up' aria-hidden='true'></i>").html_safe, url_for( :sortby => column.first, :order => "desc" ), method: :get %>
                <% else %>
                    <%= link_to (column.second + " <i class='fa fa-arrow-down' aria-hidden='true'></i>").html_safe, url_for( :sortby => column.first, :order => "asc" ), method: :get %>
                <% end %>
            <% else %>
                <%= link_to column.second, url_for( :sortby => column.first, :order => "asc" ), method: :get %>
            <% end %>
          </th>
      <% end %>
      <th class="cell-label cell-label--string cell-label--false" scope="col">Available actions</th>
    </tr>
    </thead>
    <%= will_paginate %><%@users.each do |user| %>
        <tbody>
        <tr class="table__row" data-url="<%= edit_admin_user_path(user) %>" role="link" tabindex="0">
          <td ><%= user.first_name %></td>
          <td><%= user.last_name %></td>
          <td><%= user.email%></td>
          <td><%= user.user_level%></td>
          <td>
            <span style="margin-right:10px;">
            <%= link_to(edit_admin_user_path(user)) do%><i class="fa fa-pencil" aria-hidden="true" ></i>Edit<%end%>
            </span>
            <%= link_to "<i class='fa fa-trash' aria-hidden='true'></i> Delete".html_safe, admin_user_path(user), method: :delete,
                        data: { confirm: "Are you sure?" } , class: "table__action--destroy" %>
          </td>
        </tr>
    <%end %>
    </tbody>
  </table>
  <%= will_paginate @users %>
</div>