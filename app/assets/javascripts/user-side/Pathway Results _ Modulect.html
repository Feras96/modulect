<!DOCTYPE html>
<!-- saved from url=(0160)http://localhost:3000/pathway-search/view_results?year=1&course=1&selected=[[[true,false,false,false]],[[false]]]&selected=[[[true,true,false,false]],[[false]]] -->
<html class="fa-events-icons-ready"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Pathway Results | Modulect</title>
      <meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="GvldPCtDlLxcRVj4U/QFmk3/nnc9l/qiX65LlSbws4U/94tYXXb4Z4EmXCrqFWQBNiB1YBz+cT57T0dYmMVMwQ==">

<link rel="stylesheet" media="all" href="./Pathway Results _ Modulect_files/application.self-fd4196d06375d513afac6bbdff369c261d332c3e47deab183b51e74b949d0456.css" data-turbolinks-track="reload">
<script src="./Pathway Results _ Modulect_files/jquery.self-bd7ddd393353a8d2480a622e80342adf488fb6006d667e8b42e4c0073393abee.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/jquery_ujs.self-784a997f6726036b1993eb2217c9cb558e1cbb801c6da88105588c56f13b466a.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/bootstrap-tagsinput.self-ce15436c64869dbbbd4d5c3121df5ca977480cfc1aa51be756ba9dab468c8769.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/typeahead.bundle.min.self-1816e28441676719763ef0e9078b0252906cb53cd85fa5959850fdf36728dec2.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/typeahead.min.self-01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/turbolinks.self-c5acd7a204f5f25ce7a1d8a0e4d92e28d34c9e2df2c7371cd7af88e147e4ad82.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/edit.self-0762f8513cdd0807e3e03b6d3cb094b0bd0d9a0d021f83851229e73989ab2338.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/bootstrap-select.min.self-7902bc5c92b695233a7fc2645db6b6c56be2ae4fb5606ee10666b73227d3fbf2.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/bootstrap.min.self-504d59678f10d79a661b6cecdce5b8c1d5bfd98e860614584c0a40399552d61f.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/dataTables.bootstrap4.min.self-9d4cde089e9c1fa7fc359fabf8d7f5ac9c1c746b7b5cb8f6a100d8b2f260b0e6.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/jQuery.scrollSpeed.self-1001c055a1da7154321732522c02e7073203197716d67bb5fcea743b43c2f62f.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/jquery.dataTables.min.self-8b623df95edd026f5ed0e213e40607da2e8d164563d1ec5daa4e48cf8c61ca8f.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/sweetalert2.min.self-e62b33356a9785d1d9f0c8ffe075987c43f06a526d237b0afc83f4b812c138b1.js.download" data-turbolinks-track="reload"></script>
<script src="./Pathway Results _ Modulect_files/application.self-4d37d7bcf4b0b32507438063ae47ba88dd0178863f7c7a2c7125b221eefea772.js.download" data-turbolinks-track="reload"></script>

      <meta name="viewport" content="width=device-width, initial-scale=1">
      <script src="./Pathway Results _ Modulect_files/bbc851b668.js.download"></script><script src="./Pathway Results _ Modulect_files/stats.js.download"></script><link href="./Pathway Results _ Modulect_files/bbc851b668.css" media="all" rel="stylesheet">
      <link rel="shortcut icon" type="image/x-icon" href="http://localhost:3000/assets/favicon-14e715ee122791ce5009bd8b6bfde7b21d04e49c0cf523fd62693a3a29a3c5cc.ico">
      <script>
         var $=jQuery.noConflict();
         
         $(document).ready(function(){
          setTimeout(fade_out, 5000);
             function fade_out() {
               $("#flash-container").fadeOut().empty();
               $("#flash-container").css("margin-bottom", "0px");
             }
         });
      </script>
   </head>
   <body>
      <div class="navbar navbar-default" id="modulect-nav">
   <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
         <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
         <span class="sr-only">Toggle navigation</span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         </button>
         <a class="navbar-brand" href="http://localhost:3000/"><img alt="Modulect" style="height: 50px" src="./Pathway Results _ Modulect_files/modulect-logo-e2f9ab8d07f96db68c78f868b90e410072f44082942bab0d22fe75f4e3cd4efc.png"></a>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
         <ul class="nav navbar-nav navbar-right">
            <li>
               <a href="http://localhost:3000/about">About</a>
            </li>
            <li>
               <a href="http://localhost:3000/">Search <i class="fa fa-search" aria-hidden="true"></i></a>
            </li>
            <li>
               <a data-method="get" href="http://localhost:3000/saved">Saved <i class="fa fa-star-o" aria-hidden="true"></i></a>
            </li>
            <li class="dropdown">
               <button class="btn btn-drop btn-default navbar-btn dropdown-toggle mobile-12-margin" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Welcome Bob  <span class="caret"></span>
               </button>
               <ul class="dropdown-menu">
                  <li> <a data-method="get" href="http://localhost:3000/admin">Administration</a>
                  </li>
                  <li role="separator" class="divider"></li>
                  <li><a data-method="get" href="http://localhost:3000/users/1/edit">My Details</a></li>
                  <li role="separator" class="divider"></li>
                  <li>
                     <a rel="nofollow" data-method="delete" href="http://localhost:3000/logout">Log out</a>
                  </li>
               </ul>
            </li>
         </ul>
      </div>
   </div>
</div>

      <div class="modulect-container">

         


         <div class="banner" style="padding-top:40px;">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1>Pathway Search</h1>
      </div>
    </div>
  </div>
</div>
<div id="white-strip-pathway">
  <div class="container">
    <div class="col-md-12 col-md-offset-1">
      <div class="row">
        <div class="col-md-4 step">
          <div class="numberCircle">1</div> My Details
        </div>
        <div class="col-md-4 step">
          <div class="numberCircle">2</div> Choose Interests &amp; Careers
        </div>
        <div class="col-md-4 step current">
          <div class="numberCircle current-circle">3</div> Results and selection
        </div>
      </div>
    </div>
  </div>
</div>
<div id="page" style="padding-top:30px;">
  <div class="container">
    <div class="col-md-10 login-card col-md-offset-1">
      <div id="log"></div>
      <div class="col-md-12">
        <div class="row">
          <h1> Time to start picking your modules </h1>
          <h4> We've added compulsory modules for you. Just click pick a module and go through the different groups of modules available. </h4>
          <h5> Don't forget that we've given you a tag match percentage to show you how much a module matches your interests and aspirations. </h5>
        </div>
        <div class="row">
          <button id="btn_year_1" class="btn btn-lg btn-block" type="button" style="margin-top: 5px">
            1st Year&nbsp;&nbsp;<i class="fa fa-angle-down" aria-hidden="true"></i>
          </button>
          <div id="div_year_1" style="margin-top: 20px; display: block;"><table id="results_table_0" style="width: 100%"><tbody><tr><th>Semester 1</th><th>Semester 2</th></tr><tr><td><div class="row login-card res-card result-card-blue res-btn" id="1" data-toggle="tooltip" data-placement="right" data-original-title="This is a compulsory module."><div class="col-md-8"><p>4CCS1PRP</p><p>Programming Practice</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/1"><i class="fa fa-info-circle" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> Compulsory </h4></div></div></td><td><div class="row login-card res-card result-card-orange res-btn" id="2" data-toggle="tooltip" data-placement="right" data-original-title="No tags matched."><div class="col-md-8"><p>4CCS1PRA</p><p>Programming Applications</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/2"><i class="fa fa-info-circle" aria-hidden="true"></i></a><a class="deselect" onclick="deselectModule(0, 0, undefined)"><i class="fa fa-trash" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> 0% </h4></div></div></td></tr><tr><td><div class="row login-card res-card result-card-blue res-btn" id="3" data-toggle="tooltip" data-placement="right" data-original-title="This is a compulsory module."><div class="col-md-8"><p>4CCS1FC1</p><p>Foundations of Computing 1</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/3"><i class="fa fa-info-circle" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> Compulsory </h4></div></div></td><td><div class="row login-card res-card result-card-orange res-btn" id="5" data-toggle="tooltip" data-placement="right" data-original-title="No tags matched."><div class="col-md-8"><p>4CCS1IAI</p><p>Artificial Intelligence</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/5"><i class="fa fa-info-circle" aria-hidden="true"></i></a><a class="deselect" onclick="deselectModule(0, 0, undefined)"><i class="fa fa-trash" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> 0% </h4></div></div></td></tr><tr><td><div class="row login-card res-card result-card-blue res-btn" id="4" data-toggle="tooltip" data-placement="right" data-original-title="This is a compulsory module."><div class="col-md-8"><p>4CCS1CS1</p><p>Computer Systems</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/4"><i class="fa fa-info-circle" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> Compulsory </h4></div></div></td><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear1"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td></tr><tr><td><div class="row login-card res-card result-card-blue res-btn" id="8" data-toggle="tooltip" data-placement="right" data-original-title="This is a compulsory module."><div class="col-md-8"><p>4CCS1ELA</p><p>Elementary Logic With Applications</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/8"><i class="fa fa-info-circle" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> Compulsory </h4></div></div></td><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear1"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td></tr></tbody></table></div>
          <div class="modal fade" id="optionsModalYear1" tabindex="-1" role="dialog" aria-hidden="true" style="margin-top: 50px">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                  </button>
                  <h2 class="modal-title" id="exampleModalLabel">Select a Module:</h2>
                </div>
                <div class="modal-body" id="optionsModalBodyYear1"><div id="pathway-tabs"><ul class="nav nav-tabs"><li><a role="tab" data-toggle="tab" id="btn_opt_year_0_group_0">Semester 2</a></li></ul></div><div class="tab-pane fade in active col-md-12" id="div_opt_year_0" style="padding-top: 20px"></div></div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
          <button id="btn_year_2" class="btn btn-lg btn-block" type="button" style="margin-top: 5px">
            2nd Year&nbsp;&nbsp;<i class="fa fa-angle-down" aria-hidden="true"></i>
          </button>
          <div id="div_year_2" style="margin-top: 20px; display: none;"><table id="results_table_1" style="width: 100%"><tbody><tr><th>Semester 1</th><th>Semester 2</th></tr><tr><td><div class="row login-card res-card result-card-blue res-btn" id="9" data-toggle="tooltip" data-placement="right" data-original-title="This is a compulsory module."><div class="col-md-8"><p>5CCS2INS</p><p>Internet Systems</p></div><div class="col-md-1" style="font-size: 18px; float: right; padding-top: 15px"><a href="http://localhost:3000/uni_modules/9"><i class="fa fa-info-circle" aria-hidden="true"></i></a></div><div class="col-md-3 tag-match-figure" style="font-size:18px; padding-left: 0px"><h4> Compulsory </h4></div></div></td><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td></tr><tr><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td></tr><tr><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td></tr><tr><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td><td><button type="button" class="row login-card res-card res-btn" data-toggle="modal" data-target="#optionsModalYear2"><div class="col-md-12" style="font-size: 18px; text-align: center"><p> + Pick a Module </p></div></button></td></tr></tbody></table></div>
          <div class="modal fade" id="optionsModalYear2" tabindex="-1" role="dialog" aria-hidden="true" style="margin-top: 50px">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                  </button>
                  <h2 class="modal-title" id="exampleModalLabel">Select a Module:</h2>
                </div>
                <div class="modal-body" id="optionsModalBodyYear2"><div id="pathway-tabs"><ul class="nav nav-tabs"><li><a role="tab" data-toggle="tab" id="btn_opt_year_1_group_0">Semester 2</a></li></ul></div><div class="tab-pane fade in active col-md-12" id="div_opt_year_1" style="padding-top: 20px"></div></div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        <button id="btn_all_years" class="btn btn-lg btn-block" type="button" style="margin-top: 5px">show all</button>
        </div>
        <div class="row" style="margin-left:-30px;">
          <form onsubmit="savePathway();return false;" style="margin-top: 30px">
            <div class="col-md-3">
              <button type="submit" class="btn btn-lg" id="save"><span><i class="fa fa-star-o" aria-hidden="true"></i>&nbsp;&nbsp;Save Pathway</span>
              </button>
            </div>
            <div class="col-md-4">
              <input type="text" class="form-control" id="save-name" placeholder="Name your Pathway" required="">
            </div>
          </form>
        </div>
        <div class="row nomobile" style="margin-top:-20px;margin-bottom:10px;">
          <div class="col-md-10 col-md-offset-1 text-right">
            <ul class="results-page-options">
              <li><a href="javascript:void()" onclick="window.print()"><i class="fa fa-print" aria-hidden="true"></i>&nbsp;&nbsp;Print page</a></li>
              <li><a href="mailto:?subject=Modulect%20|%20Please%20check%20my%20modules&amp;body=Hello%20{Insert%20name},%0A%0AI%20used%20KCL%20Modulect%20to%20view%20which%20optional%20modules%20I%20should%20take%20in%20order%20to%20reach%20my%20career%20goals.%20Please%20take%20a%20look%20at%20this%20link:%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20http://localhost:3000/pathway-search/view_results?year=1%26course=1%26selected=[[[true,false,false,false]],[[false]]]%26selected=[[[true,true,false,false]],[[false]]]%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Regards,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20{Insert%20name}" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i>&nbsp;&nbsp;Email someone</a> </li>
            </ul>
          </div>
        </div>
      <div class="form-group" style="margin-top: 30px">
        <a href="javascript:void()" onclick="javascript:history.back()">&lt; Back to previous page</a>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  /*
  
  TODO:
  1) add valitation to select and deselect functions
  2) add notifications
  3) colour-code groups
  4) right now when the year divs are updated, all the slide-down divs are getting hidden again
    this should not be an issue since rather than having a slide-down div, we're more likely to have
    a pop-up selection div


  ISSUES:
  1) What happens when the order of modules in optional groups is changed?
  */

  // get JSON object from rails
  var data = '{"id":1,"name":"BSc Computer Science","description":null,"created_at":"2017-03-03T23:02:21.913Z","updated_at":"2017-03-03T23:02:21.913Z","year":2015,"year_structures":[{"id":1,"year_of_study":"first_year","course_id":1,"created_at":"2017-03-03T23:02:22.438Z","updated_at":"2017-03-03T23:02:22.438Z","groups":[{"id":1,"name":"Semester 1","total_credits":60,"year_structure_id":1,"created_at":"2017-03-03T23:02:22.496Z","updated_at":"2017-03-03T23:02:22.864Z","compulsory":true,"uni_modules":[{"id":1,"name":"Programming Practice","code":"4CCS1PRP","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:20.893Z","updated_at":"2017-03-03T23:02:20.893Z","pass_rate":"40","assessment_methods":null,"semester":"1","credits":15,"exam_percentage":null,"coursework_percentage":null,"more_info_link":"http://www.kcl.ac.uk/nms/depts/informatics/study/current/handbook/progs/Modules/4CCS1PRP.aspx"},{"id":3,"name":"Foundations of Computing 1","code":"4CCS1FC1","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:20.944Z","updated_at":"2017-03-03T23:02:20.944Z","pass_rate":null,"assessment_methods":null,"semester":"1","credits":15,"exam_percentage":90,"coursework_percentage":10,"more_info_link":null},{"id":4,"name":"Computer Systems","code":"4CCS1CS1","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:20.970Z","updated_at":"2017-03-03T23:02:20.970Z","pass_rate":"45","assessment_methods":null,"semester":"1","credits":15,"exam_percentage":85,"coursework_percentage":15,"more_info_link":null},{"id":8,"name":"Elementary Logic With Applications","code":"4CCS1ELA","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:21.068Z","updated_at":"2017-03-03T23:02:21.068Z","pass_rate":"30","assessment_methods":null,"semester":"1","credits":15,"exam_percentage":null,"coursework_percentage":null,"more_info_link":null}]},{"id":2,"name":"Semester 2","total_credits":60,"year_structure_id":1,"created_at":"2017-03-03T23:02:22.522Z","updated_at":"2017-03-03T23:02:22.891Z","compulsory":false,"uni_modules":[{"id":2,"name":"Programming Applications","code":"4CCS1PRA","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:20.920Z","updated_at":"2017-03-03T23:02:20.920Z","pass_rate":"50","assessment_methods":null,"semester":"2","credits":15,"exam_percentage":75,"coursework_percentage":25,"more_info_link":null},{"id":5,"name":"Artificial Intelligence","code":"4CCS1IAI","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:20.993Z","updated_at":"2017-03-03T23:02:20.993Z","pass_rate":null,"assessment_methods":null,"semester":"2","credits":15,"exam_percentage":70,"coursework_percentage":30,"more_info_link":null},{"id":6,"name":"Data Structures","code":"4CCS1DST","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:21.016Z","updated_at":"2017-03-03T23:02:21.016Z","pass_rate":"30","assessment_methods":null,"semester":"2","credits":15,"exam_percentage":85,"coursework_percentage":15,"more_info_link":null},{"id":7,"name":"Database Systems","code":"4CCS1DBS","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:21.044Z","updated_at":"2017-03-03T23:02:21.044Z","pass_rate":"45","assessment_methods":null,"semester":"2","credits":15,"exam_percentage":85,"coursework_percentage":15,"more_info_link":null}]}]},{"id":2,"year_of_study":"second_year","course_id":1,"created_at":"2017-03-03T23:02:22.461Z","updated_at":"2017-03-03T23:02:22.461Z","groups":[{"id":3,"name":"Semester 1","total_credits":60,"year_structure_id":2,"created_at":"2017-03-03T23:02:22.546Z","updated_at":"2017-03-03T23:02:22.915Z","compulsory":true,"uni_modules":[{"id":9,"name":"Internet Systems","code":"5CCS2INS","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:21.090Z","updated_at":"2017-03-03T23:02:21.090Z","pass_rate":"60","assessment_methods":null,"semester":"1","credits":15,"exam_percentage":80,"coursework_percentage":20,"more_info_link":null}]},{"id":4,"name":"Semester 2","total_credits":60,"year_structure_id":2,"created_at":"2017-03-03T23:02:22.568Z","updated_at":"2017-03-03T23:02:22.941Z","compulsory":false,"uni_modules":[{"id":10,"name":"Foundations of Computing 2","code":"5CCS2FC2","description":null,"lecturers":null,"created_at":"2017-03-03T23:02:21.117Z","updated_at":"2017-03-03T23:02:21.117Z","pass_rate":"70","assessment_methods":null,"semester":"2","credits":15,"exam_percentage":100,"coursework_percentage":0,"more_info_link":null}]}]}]}';
  var js_course = jQuery.parseJSON(data);

  // globals to keep track of selected modules
  var selected_modules_per_year = [[[true,true,false,false]],[[false]]];
  var required_modules_per_year = [];
  var optional_modules_per_year = [];

  var btns = [];
  var divs = [];
  for(i=1; i<10; i++){
    var btn = document.getElementById("btn_year_"+i);
    var div = document.getElementById("div_year_"+i);
    if(!btn) break;
    else{
      $(div).hide();
      total_years = i;
      divs.push(div);
      btns.push(btn);
    }

  }
  for(var i=0; i<btns.length; i++){
    (function(_i){
      $(btns[_i]).click(function () {
        showYear(divs, _i);
      });
    })(i);
  }
  $("#btn_all_years").click(function () {
    for(i=0; i<divs.length; i++){
      $(divs[i]).slideDown();
    }
  });

  $("#save").click(function() {
    document.getElementById("save").innerHTML= "<span><i class=\"fa fa-star\" aria-hidden=\"true\"></i>&nbsp;&nbsp;Saved</span>";
  });

  function savePathway() {
    $.ajax({
        type: "POST",
        url: "/application/save_pathway",
        data: {
            name: document.getElementById('save-name').value,
            data: JSON.stringify(selected_modules_per_year),
            year: 1,
            course: 1
        }
    })      
  }

  // selected modules this year is all set to false
  updateData();
  
  updateUI();

  // debugging
  // logStatus();
  function logStatus(){
    console.log("JSON course object");
    console.log(js_course);
    console.log("Required modules per year");
    console.log(required_modules_per_year);
    console.log("Optional modules per year");
    console.log(optional_modules_per_year);
    console.log("Selected modules per year");
    console.log(selected_modules_per_year);
  }

  // show and hide year div
  function showYear(divs, year){
    for(i=0; i<divs.length; i++){
      if(i!=year) $(divs[i]).slideUp();
    }
    $(divs[year]).slideDown();
  }

  function colour_code_card_group(module_matches, search_tags) {
    if((module_matches.length / search_tags.length) > 0.6) {
      return "green"
    } else {
      return "orange"
    }
  }


  function create_module_card(module, isOptional, year, group, gName, modIndex) {
    var result = [].filter(function(mod) {
      if(mod[0].id == module.id){
        return mod;
      }
    });
    if(!isOptional) {
      var moduleCard = "<div class=\"row login-card res-card result-card-blue res-btn\" id=\"" + module.id + "\" data-toggle=\"tooltip\" data-placement=\"right\" data-original-title=\"This is a compulsory module.\">" +
        "<div class=\"col-md-8\" >" +
          "<p>" + module.code + "</p>" +
          "<p>" + module.name + "</p>" +
        "</div>" +
         "<div class=\"col-md-1\" style=\"font-size: 18px; float: right; padding-top: 15px\">" +
            "<a href=\"/uni_modules/" + module.id + "\"><i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>" +
          "</div>" +
         "<div class=\"col-md-3 tag-match-figure\" style=\"font-size:18px; padding-left: 0px\">" +
          "<h4> Compulsory </h4>" +
        "</div>" +
      "</div>"
      return moduleCard;
    }

    if(result.length > 0) {
      var tagsmatched = result[0][1];
      var moduleCard =  "<div class=\"row login-card res-card result-card-" + colour_code_card_group(tagsmatched, []) +  " res-btn\" id=\"" + module.id + "\" data-toggle=\"tooltip\" data-placement=\"right\" data-original-title=\"Tags Matched: " + tagsmatched.join(", ") + "\">" +
        "<div class=\"col-md-8\">" +
          "<p>" +  module.code + "</p>" +
          "<p>" + module.name + "</p>" +
        "</div>" +
        "<div class=\"col-md-1\" style=\"font-size: 18px; float: right; padding-top: 15px\">" +
          "<a href=\"/uni_modules/" + module.id + "\"><i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>";
           if(isOptional) {
            moduleCard += "<a class=\"deselect\" onclick = \"deselectModule(" + year + ", " + group + ", " + modIndex + ")\"><i class=\"fa fa-trash\" aria-hidden=\"true\"></i></a>";
          }
          moduleCard += "</div>" +
        "<div class=\"col-md-3 tag-match-figure\" style=\"font-size:18px; padding-left: 0px\">" +
          "<h4>" + Math.round((tagsmatched.length / [].length) * 100) + " %</h4>" +
        "</div>" +
      "</div>"
      return moduleCard;
    } else {
      var moduleCard = "<div class=\"row login-card res-card result-card-orange res-btn\" id=\"" + module.id + "\" data-toggle=\"tooltip\" data-placement=\"right\" data-original-title=\"No tags matched.\">" +
        "<div class=\"col-md-8\">" +
          "<p>" +  module.code + "</p>" +
          "<p>" + module.name + "</p>" +
        "</div>" +
         "<div class=\"col-md-1\" style=\"font-size: 18px; float: right; padding-top: 15px\">" +
          "<a href=\"/uni_modules/" + module.id + "\"><i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>";
          if(isOptional) {
            moduleCard += "<a class=\"deselect\" onclick = \"deselectModule(" + year + ", " + group + ", " + modIndex + ")\"><i class=\"fa fa-trash\" aria-hidden=\"true\"></i></a>";
          }
          moduleCard += "</div>" +
         "<div class=\"col-md-3 tag-match-figure\" style=\"font-size:18px; padding-left: 0px\">" +
          "<h4> 0% </h4>" +
        "</div>" +
      "</div>"
      return moduleCard;
    }
  }

  function create_blank_cell(year) {
    return "<button type=\"button\" class=\"row login-card res-card res-btn\" data-toggle=\"modal\" data-target=\"#optionsModalYear" + year + "\">" +
        "<div class=\"col-md-12\" style=\"font-size: 18px; text-align: center\">" +
          "<p> + Pick a Module </p>" +
        "</div>" +
      "</button>"
  }


  function updateUI(){
    for(year=0; year<js_course.year_structures.length; year++){
      // get all optional modules
      selected_modules_buttons_any_semester = [];
      selected_modules_buttons_first_semester = [];
      selected_modules_buttons_second_semester = [];
      selected_modules_buttons_year_long = [];
      for(g=0; g<optional_modules_per_year[year].length; g++){
        for(index=0; index<selected_modules_per_year[year][g].length; index++){
          if(selected_modules_per_year[year][g][index]){
            semester = optional_modules_per_year[year][g].uni_modules[index].semester;
            sel_module = [optional_modules_per_year[year][g].uni_modules[index], year, g, index];
            if(semester == 0) selected_modules_buttons_any_semester.push(sel_module);
            if(semester == 1) selected_modules_buttons_first_semester.push(sel_module);
            if(semester == 2) selected_modules_buttons_second_semester.push(sel_module);
            if(semester == 3) selected_modules_buttons_year_long.push(sel_module);
          }
        }
      }


      targetDiv = document.getElementById("div_year_" + (year+1));
      myTable = "<table id =\"results_table_" + year + "\" style=\"width: 100%\"><tr><th>Semester 1</th><th>Semester 2</th></tr>";
      s1 = 0; // keeping track of column positions
      s2 = 0;

      // create the table and fill in year long modules first
      for(i=0; i<required_modules_per_year[year][0].length; i++){
        myTable += "<tr><td colspan=2>" + create_module_card(required_modules_per_year[year][0][i], false, 0, 0, 0) + "</td></tr>";
        s1++;
        s2++;
      }
      for(i=0; i<selected_modules_buttons_year_long.length; i++){
        myTable += "<tr><td colspan=2>" + create_module_card(selected_modules_buttons_year_long[i][0], true, selected_modules_buttons_year_long[i][1], selected_modules_buttons_year_long[i][2], selected_modules_buttons_year_long[i][3]) + "</td></tr>";
        s1++;
        s2++;
      }
      for(i=s1; i<4; i++){
        myTable +="<tr><td>" + create_blank_cell(year+1) + "</td><td>" + create_blank_cell(year+1) + "</td></tr>";
      }
      myTable += "</table>";      
      targetDiv.innerHTML = myTable;

      // find the table we've just created
      myTableOnPage = document.getElementById('results_table_'+year);
      // fill required modules in 1st semester
      for(i=0; i<required_modules_per_year[year][1].length; i++){
        myTableOnPage.rows[++s1].cells[0].innerHTML = create_module_card(required_modules_per_year[year][1][i], false, 0, 0, 0);
      }
      for(i=0; i < selected_modules_buttons_first_semester.length; i++){
        myTableOnPage.rows[++s1].cells[0].innerHTML = create_module_card(selected_modules_buttons_first_semester[i][0], true, selected_modules_buttons_first_semester[i][1], selected_modules_buttons_first_semester[i][2], selected_modules_buttons_first_semester[i][3]);
      }
      // 2nd semester
      for(i=0; i<required_modules_per_year[year][2].length; i++){
        myTableOnPage.rows[++s2].cells[1].innerHTML = create_module_card(required_modules_per_year[year][2][i], false, 0, 0, 0);
      }
      for(i=0; i < selected_modules_buttons_second_semester.length; i++){
        myTableOnPage.rows[++s2].cells[1].innerHTML = create_module_card(selected_modules_buttons_second_semester[i][0], true, selected_modules_buttons_second_semester[i][1], selected_modules_buttons_second_semester[i][2], selected_modules_buttons_second_semester[i][3]);
      }

      // fill modules that can go to any semester
      for(i=0; i<required_modules_per_year[year][3].length; i++){
        if(s2<s1){
          myTableOnPage.rows[++s2].cells[1].innerHTML = create_module_card(required_modules_per_year[year][3][i], false, 0, 0, 0);
        }else{
          myTableOnPage.rows[++s1].cells[0].innerHTML = create_module_card(required_modules_per_year[year][3][i], false, 0, 0, 0);
        }
      }
      for(i=0; i < selected_modules_buttons_any_semester.length; i++){
        if(s2<s1){
          myTableOnPage.rows[s2+1].cells[1].innerHTML = create_module_card(selected_modules_buttons_second_semester[i][0], true, selected_modules_buttons_second_semester[i][1], selected_modules_buttons_second_semester[i][2], selected_modules_buttons_second_semester[i][3]);
          s2++;
        }else{
          myTableOnPage.rows[s1+1].cells[0].innerHTML = create_module_card(selected_modules_buttons_second_semester[i][0], true, selected_modules_buttons_second_semester[i][1], selected_modules_buttons_second_semester[i][2], selected_modules_buttons_second_semester[i][3]);
          s1++;
        }
      }


      // generate optional modules buttons
      modalTarget = document.getElementById("optionsModalBodyYear" + (year + 1));
      modalTarget.innerHTML = "";
      nav = "<div id=\"pathway-tabs\"><ul class=\"nav nav-tabs\">";
      for(i=0; i<optional_modules_per_year[year].length; i++){  
        out = "<li><a role=\"tab\" data-toggle=\"tab\" id = \"btn_opt_year_"+year+"_group_"+i+"\">" + optional_modules_per_year[year][i].name + "</a></li>";
          nav += out;
      }
      nav += "</ul></div><div class=\"tab-pane fade in active col-md-12\" id = \"div_opt_year_" + year + "\" style=\"padding-top: 20px\"></div>";
      modalTarget.innerHTML += nav;


      for(i=0; i<optional_modules_per_year[year].length; i++){
        (function(_year, _i){
          button = document.getElementById("btn_opt_year_" + _year + "_group_" + _i);
          button.addEventListener("click", function(){
            optional_button_pressed(_year, _i);
          });
        })(year, i);  
      }

    }
  }

  function optional_button_pressed(_year, _i){
    target = document.getElementById("div_opt_year_" + _year);
    target.innerHTML = "";
    // Sort the optional modules by their tags matched percentage
    var addedModules = [];
    for(i = 0; i < optional_modules_per_year[_year][_i].uni_modules.length; ++i) {
      uni_mod = optional_modules_per_year[_year][_i].uni_modules[i];
      var result = [].filter(function(mod) {
        if(mod[0].id == uni_mod.id){
          return mod;
        }
      });
      if(result.length > 0) {
        var tagsmatched = result[0][1];
        moduleCard = "<div class =\"row\">" +
                              "<button type=\"button\" class=\"login-card res-card result-card-" + colour_code_card_group(tagsmatched, []) +  " res-btn\" id =\"btn_opt_select_year_"+_year+"_group_"+_i+"_index_"+i+"\" style=\"text-align: left\" data-toggle=\"tooltip\" data-placement=\"right\" data-original-title=\"Tags Matched: " + tagsmatched.join(", ") + "\"";
                                  if(selected_modules_per_year[_year][_i][i]) {
                                    moduleCard += " disabled ";
                                  }
                                moduleCard += ">" +
                                "<div class=\"col-md-8\" style\"width: 75%\">" +
                                  "<p>" +  uni_mod.code + "</p>" +
                                  "<p>" + uni_mod.name + "</p>" +

                                "</div>" +
                                "<div class=\"col-md-1\" style=\"font-size: 18px; float: right\">" +
                                  "<a href=\"/uni_modules/" + uni_mod.id + "\"><i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>";
                                  if(selected_modules_per_year[_year][_i][i]) {
                                    moduleCard += "<a class=\"deselect\" onclick = \"deselectModule(" + _year + ", " + _i + ", " + i + ")\"><i class=\"fa fa-trash\" aria-hidden=\"true\"></i></a>";
                                  }
                                moduleCard += "</div>" +
                                "<div class=\"col-md-3 tag-match-figure\" style=\"font-size:18px; padding-left: 0px\">" +
                                  "<h4>" + Math.round((tagsmatched.length / [].length) * 100) + " %</h4>" +        
                                "</div>"
                              "</button>" +
                            "</div>";
        target.innerHTML += moduleCard;
        addedModules.push(uni_mod);
      }
    }
    for(i = 0; i < optional_modules_per_year[_year][_i].uni_modules.length; ++i) {
      uni_mod = optional_modules_per_year[_year][_i].uni_modules[i];
       var foundAlready = addedModules.filter(function(mod) {
        if(mod.id == uni_mod.id){
          return mod;
        }
      });
      if(foundAlready.length == 0) {
        moduleCard = "<div class =\"row\">" +
                              "<button type=\"button\" class=\"login-card res-card result-card-orange res-btn\" id =\"btn_opt_select_year_"+_year+"_group_"+_i+"_index_"+i+"\" style=\"text-align: left\" data-toggle=\"tooltip\" data-placement=\"right\" data-original-title=\"No tags matched.\"";
                                if(selected_modules_per_year[_year][_i][i]) {
                                    moduleCard += " disabled ";
                                  }
                                moduleCard += ">" +
                                "<div class=\"col-md-8\" style\"width: 75%\">" +
                                  "<p>" +  uni_mod.code + "</p>" +
                                  "<p>" + uni_mod.name + "</p>" +
                                "</div>" +
                                "<div class=\"col-md-1\" style=\"font-size: 18px; float: right\">" +
                                  "<a href=\"/uni_modules/" + uni_mod.id + "\"><i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>";
                                  if(selected_modules_per_year[_year][_i][i]) {
                                    moduleCard += "<a class=\"deselect\" onclick = \"deselectModule(" + _year + ", " + _i + ", " + i + ")\"><i class=\"fa fa-trash\" aria-hidden=\"true\"></i></a>";
                                  } 
                                 moduleCard += "</div>" +
                                "<div class=\"col-md-3 tag-match-figure\" style=\"font-size:18px; padding-left: 0px\">" +
                                  "<h4> 0% </h4>" +
                                "</div>"
                              "</button>" +
                            "</div>";
        target.innerHTML += moduleCard;
      }
    }

    for(i=0; i<optional_modules_per_year[_year][_i].uni_modules.length; i++){
      if(!selected_modules_per_year[_year][_i][i]){
        (function(_year_, _i_, i_){
          button = document.getElementById("btn_opt_select_year_" + _year_ + "_group_" + _i_+"_index_"+i_);
          button.addEventListener("click", function(){
            $("#optionsModalYear" + (_year + 1)).modal('hide');
            selectModule(_year_,_i_,i_);
          });
        })(_year, _i, i);
      }
    }
  }

  function selectModule(year, group, module){
    logStatus();
    console.log("########################################");
    console.log("########### selecting module ###########");
    // TODO: validate
    this_module = optional_modules_per_year[year][group].uni_modules[module];

    // 1. Make sure we don't go over max modules per group
    group_credits = optional_modules_per_year[year][group].total_credits;
    console.log("max allowed credits in this group: " + group_credits);
    credits_used = 0;
    for(i=0; i<selected_modules_per_year[year][group].length; i++){
      if(selected_modules_per_year[year][group][i]){
        credits_used += optional_modules_per_year[year][group].uni_modules[i].credits;
      }
    }
    console.log("credits already used: " + credits_used);
    console.log("----------------------------------------");

    // 2. Don't select more than 120 credits worth modules per year
    credits_this_year = 0;
    for(g=0; g<required_modules_per_year[year].length; g++){
      for(i=0; i<required_modules_per_year[year][g].length; i++){
        credits_this_year += required_modules_per_year[year][g][i].credits;
          console.log(required_modules_per_year[year][g][i].name + 
            " (" + required_modules_per_year[year][g][i].credits + ")");
      }
    }
    for(g=0; g<selected_modules_per_year[year].length; g++){
      for(i=0; i<selected_modules_per_year[year][g].length; i++){
        console.log("checking selected [y=" + year + ", g=" + g + ", i=" + i + "]");
        if(selected_modules_per_year[year][g][i]){
          credits_this_year += optional_modules_per_year[year][g].uni_modules[i].credits;
          console.log(optional_modules_per_year[year][g].uni_modules[i].name + 
            " (" + optional_modules_per_year[year][g].uni_modules[i].credits + ")");
        }
      }
    } 
    console.log("credits used this year: " + credits_this_year);      
    console.log("----------------------------------------");

    // 3. Don't add more than allowed number of modules per semester
    total_any = 0;
    total_1st = 0;
    total_2nd = 0;
    // add required modules
    req_modules_any = 0;
    req_modules_1st = 0;
    req_modules_2nd = 0;
    for(i=0; i<js_course.year_structures[year].groups[0].uni_modules.length; i++){
      if(js_course.year_structures[year].groups[0].uni_modules[i].semester == 0)
        req_modules_any++;
      else if(js_course.year_structures[year].groups[0].uni_modules[i].semester == 1) 
        req_modules_1st++;
      else if(js_course.year_structures[year].groups[0].uni_modules[i].semester == 2) 
        req_modules_2nd++;
      else if(js_course.year_structures[year].groups[0].uni_modules[i].semester == 3){
        req_modules_1st++;
        req_modules_2nd++;  
      }     
    }
    // add selected optional modules
    opt_modules_any = 0;
    opt_modules_1st = 0;
    opt_modules_2nd = 0;
    for(g=0; g<selected_modules_per_year[year].length; g++){
      for(i=0; i<selected_modules_per_year[year][g].length; i++){
        if(selected_modules_per_year[year][g][i]){
          if(optional_modules_per_year[year][g].uni_modules[i].semester == 0)
            opt_modules_any++;
          else if(optional_modules_per_year[year][g].uni_modules[i].semester == 1)
            opt_modules_1st++;
          else if(optional_modules_per_year[year][g].uni_modules[i].semester == 2)
            opt_modules_2nd++;
          else if(optional_modules_per_year[year][g].uni_modules[i].semester == 3){
            opt_modules_1st++;
            opt_modules_2nd++;
          }


        }
      }
    }
    total_any = opt_modules_any + req_modules_any;
    total_1st = opt_modules_1st + req_modules_1st;
    total_2nd = opt_modules_2nd + req_modules_2nd;
    can_add = false;
    // any semester should be able to add anywhere as long as there is a slot in either row
    if(this_module.semester == 0){
      if(total_1st + total_2nd + total_any < 8)
        can_add = true;
    }
    // If first semester, then check that
    // a. there is a space in 1st semester
    // b. there is enough free space left after that to place all "any" modules
    else if(this_module.semester == 1){
      if(total_1st < 4 && ( (8 - total_1st - total_2nd - 1) >= total_any ))
        can_add = true;
    }
    // same check for semester 2
    else if(this_module.semester == 2){
      if(total_2nd < 4 && ( (8 - total_1st - total_2nd - 1) >= total_any ))
        can_add = true;
    }
    // check for year-long moludels.
    else if(this_module.semester == 3){
      if(total_1st < 4 && total_2nd < 4 && ( (8 - total_1st - total_2nd - 2) >= total_any ))
        can_add = true; 
    }
    console.log("1st semester: " + total_1st + " modules");
    console.log("2nd semester: " + total_2nd + " modules");
    console.log("Any semester: " + total_any + " modules");
    console.log("----------------------------------------");

    if(credits_used>=group_credits){
      window.alert("You have already selected enought modules from this group");
    }else if(credits_this_year+this_module.credits > 120){
      window.alert("You have enough credits this year");
    }else if(!can_add){
      window.alert("Addind this module would exceed the maximum allowed number of modules per semester");
    }
    else{
      selected_modules_per_year[year][group][module] = true;
      updateUI();
    }


    //Tell the user they can now save again
    document.getElementById("save").innerHTML= "<span><i class=\"fa fa-star-o\" aria-hidden=\"true\"></i>&nbsp;&nbsp;Save Pathway</span>";

    //logStatus();
  }

  function deselectModule(year, group, module){
    // TODO: validate
    selected_modules_per_year[year][group][module] = false;
    updateUI();
  }

  function updateData(){
    // go through each year
    for(year=0; year<js_course.year_structures.length; year++){

      // sort required modules for this year
      required_group = js_course.year_structures[year].groups[0].uni_modules;
      modules_year_long = [];
      modules_first_semester = [];
      modules_second_semester = [];
      modules_any_semester = [];
      required_modules_this_year = [];
      for(module=0; module<required_group.length; module++){
        if     (required_group[module].semester == 3) modules_year_long.push(required_group[module]);
        else if(required_group[module].semester == 2) modules_second_semester.push(required_group[module]);
        else if(required_group[module].semester == 1) modules_first_semester.push(required_group[module]);
        else                        modules_any_semester.push(required_group[module]);
      }
      required_modules_this_year.push(modules_any_semester);
      required_modules_this_year.push(modules_first_semester);
      required_modules_this_year.push(modules_second_semester);
      required_modules_this_year.push(modules_year_long);

      optional_modules_this_year = [];
      for(grp=1; grp<js_course.year_structures[year].groups.length; grp++){
        optional_modules_this_year.push(js_course.year_structures[year].groups[grp]);
      }

      selected_modules_this_year = [];
      for(grp=1; grp<js_course.year_structures[year].groups.length; grp++){
        selected_modules_in_this_group = [];
        for(mod=0; mod<js_course.year_structures[year].groups[grp].uni_modules.length; mod++){
          selected_modules_in_this_group.push(false);
        }
        selected_modules_this_year.push(selected_modules_in_this_group);
      }

      optional_modules_per_year.push(optional_modules_this_year);
      required_modules_per_year.push(required_modules_this_year);
      selected_modules_per_year.push(selected_modules_this_year);
    }

    document.getElementById('btn_year_1').click();
  }
</script>




         <div class="row" style="margin-top:40px;" id="after-content">
	<div class="col-md-12 text-center">
		<p>Need help? <a href="http://localhost:3000/contact">Contact Modulect for KCL support</a></p>
    </div>
</div>
      </div>
      </div>
      <footer>
    <div class="footer-bottom">
      <div class="container">
      <img alt="rss feed" class="pull-left" id="footer-logo" src="./Pathway Results _ Modulect_files/modulect-logo-e2f9ab8d07f96db68c78f868b90e410072f44082942bab0d22fe75f4e3cd4efc.png">
        <div class="pull-right">
          <h4 id="rec-husky-footer">By Recursive Husky</h4>
        </div>
      </div>
    </div>
</footer>
<script>  
      /*$(function() {  
        jQuery.scrollSpeed(120, 400);
    });*/
  $(document).ready(function(){
       jQuery('[data-toggle="tooltip"]').tooltip();

 });
</script>

      
   

</body></html>